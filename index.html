<html>
<head>
	<title>Web Service, Assignment A8</title>
	<link href="styles.css" rel="stylesheet"/>
	<script src="http://code.jquery.com/jquery-latest.js" type="text/javascript"></script>
	<script type="text/javascript">
		$(document).ready(function () {
			$('.category').click(function (e) {
				//stop default action of the link
				e.preventDefault();

				//Get category from URL
				var cat = $(this).attr("href");

				//Get description for header from value attribute
				var description = $(this).attr("value");

				// Change heading
				$('#plants').html('<h2 id="head">' + description + " Plants</h2>");

				loadAJAX(cat);  //load AJAX and parse JSON file
			});

			// Get year for copyright
			var currentYear = new Date();
			var getYear = currentYear.getFullYear();
			$("#copyright").text(getYear);
		});

		function loadAJAX(cat) {
			$.ajax({
				type: "GET",
				dataType: "json",
				url: "api.php?cat=" + cat,
				success: parseJSON,
			});
		}

		function parseJSON(data) {
			$.each(data, function (i, item) {
				var text = '<div class="photo" style="background-image:url(images/' + item.photo + ')" /></div>';
				text += '<strong>Common name:  </strong>' + '<span>' + item.common_name + '</span><br />';
				text += '<strong>Latin name:  </strong>' + '<span>' + item.latin_name + '</span><br />';
				text += '<strong>Moisture:  </strong>' + '<span>' + item.moisture + '</span><br />';
				text += '<strong>Exposure:  </strong>' + '<span>' + item.exposure + '</span><br />';
				text += '<strong>Ease of Growth:  </strong>' + '<span>' + item.ease + '</span><br />';
				text += '<strong>Height (ft):  </strong>' + '<span>' + item.height_ft + '</span><br />';
				text += '<a href="' + item.King_county_link + '">More information through King County</a>';
//				text += '<img src="images/' + item.photo + '" alt="Picture of ' + item.commonname + '" align="right" />';

//				url("paper.gif");

				// Create li node, add text node to it (from JSON data) and append it to #plants
				$('<li></li>').html(text).appendTo('#plants');
			});
		}
	</script>
</head>
<body>

<div class="container clearfix">
	<header>
		<div class="wrapper">

			<h1>Common Northwest<br />Native Plants</h1>
			<nav>
				<ul>
					<li>Sort by: </li>
					<li><a href="plants-by-size" class="category" value="Largest to Smallest">Size</a></li>
					<li><a href="plants-easy-to-grow" class="category" value="Easiest to Most Difficult to Grow">Difficulty</a></li>
				</ul>
			</nav>

		</div>
	</header>

	<main>
		<h2 id="head">Plants</h2>
		<div class="wrapper">
			<ul id="plants" class="plants">
			</ul>
		</div>
	</main>

	<footer>
		<div class="wrapper">
			<small>&copy; <span id="copyright"></span>, All Rights Reserved ~
				<a href="http://validator.w3.org/check/referer" target="_blank">Valid HTML</a> ~
				<a href="http://jigsaw.w3.org/css-validator/check?uri=referer" target="_blank">Valid CSS</a>
			</small>
		</div>
	</footer>
</div>

</body>
</html>